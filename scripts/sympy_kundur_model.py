from sympy import *
import sympy
init_printing()

sigma = symbols('sigma')

yp = 1/(0.0001 + 2.6525824*10**(-6)*sigma)
ysp = 1/(0.65973446*sigma)
yt = 397.88736*10**(-6)*sigma
y  = Matrix([
#	1	2	3	4	5	6	7	8	9	10	11
	[ 0	, 0	, 0	, 0	, yt	, 0	, 0	, 0	, 0	, 0	, 0	], #1
	[ 0	, 0	, 0	, 0	, 0	, yt	, 0	, 0	, 0	, 0	, 0	], #2
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, yt	], #3
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, yt	, 0	], #4
	[ yt	, 0	, 0	, 0	, 0	, yp/25	, 0	, 0	, 0	, 0	, 0	], #5
	[ 0	, 0	, 0	, 0	, yp/25	, 0	, yp/10	, 0	, 0	, 0	, 0	], #6
	[ 0	, 0	, 0	, 0	, 0	, yp/10	, 0	, yp/55	, 0	, 0	, 0	], #7
	[ 0	, 0	, 0	, 0	, 0	, 0	, yp/55	, 0	, yp/55	, 0	, 0	], #8
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, yp/55	, 0	, yp/10	, 0	], #9
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, yp/10	, 0	, yp/25	], #10
	[ 0	, 0	, yt	, 0	, 0	, 0	, 0	, 0	, 0	, yp/25	, 0	]  #11
])

ysh  = Matrix([
#	1	2	3	4	5	6	7	8	9	10	11
	[ 0	, 0	, 0	, 0	, 0 	, 0	, 0	, 0	, 0	, 0	, 0	], #1
	[ 0	, 0	, 0	, 0	, 0	, 0 	, 0	, 0	, 0	, 0	, 0	], #2
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0 	], #3
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0 	, 0	], #4
	[ 0 	, 0	, 0	, 0	, 0	, ysp/25, 0	, 0	, 0	, 0	, 0	], #5
	[ 0	, 0	, 0	, 0	, ysp/25, 0	, ysp/10, 0	, 0	, 0	, 0	], #6
	[ 0	, 0	, 0	, 0	, 0	, ysp/10, 0	, ysp/55, 0	, 0	, 0	], #7
	[ 0	, 0	, 0	, 0	, 0	, 0	, ysp/55, 0	, ysp/55, 0	, 0	], #8
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, ysp/55, 0	, ysp/10, 0	], #9
	[ 0	, 0	, 0	, 0	, 0	, 0	, 0	, 0	, ysp/10, 0	, ysp/25], #10
	[ 0	, 0	, 0 	, 0	, 0	, 0	, 0	, 0	, 0	, ysp/25, 0	]  #11
])

yL7 = (5.7704187*sigma + 94.493197)/(148.90012*10**(-6)*sigma**2 + 542.81600*10**(-3)*sigma)
yL9 = (9.8548605*sigma + 53.187942)/(78.621982*10**(-6)*sigma**2 + 523.73507*10**(-3)*sigma)

Y = -y

for i in range(10):
	Y[i,i] = sum([y[i,j] + ysh[i,j] for j in range(10)])

Y[6,6] = Y[6,6] + yL7
Y[8,8] = Y[8,8] + yL9

Y1 = Y[0:4,0:4]
Y2 = Y[0:4,4:11]

Y3 = Y[4:11,0:4]
Y4 = Y[4:11,4:11]

Yr = Y1 - Y2*Y4.inv()*Y3 

#print(Yr)

expr = simplify(Y4[:,3:11])

print(sympy.latex(
	expr,
	symbol_names = {
	sigma: "\\dpo"
	},
	imaginary_unit='j',
))
